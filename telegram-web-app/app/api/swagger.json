{"openapi":"3.0.0","paths":{"/":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"string"}}}}},"tags":["App"]}},"/auth/signup":{"post":{"operationId":"AuthController_signUp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignUpDto"}}}},"responses":{"201":{"description":"User successfully created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}}},"summary":"Sign up a new user with email and password","tags":["auth"]}},"/auth/signin":{"post":{"operationId":"AuthController_signIn","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignInDto"}}}},"responses":{"200":{"description":"User successfully authenticated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"201":{"description":""},"401":{"description":"Invalid credentials"}},"summary":"Sign in with email and password","tags":["auth"]}},"/auth/telegram_auth":{"post":{"operationId":"AuthController_telegramSignUp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TelegramAuthDto"}}}},"responses":{"201":{"description":"User successfully authenticated via Telegram","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"401":{"description":"Invalid Telegram auth data"}},"summary":"Sign up a new user through Telegram","tags":["auth"]}},"/currencies":{"post":{"operationId":"CurrencyController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCurrencyDto"}}}},"responses":{"201":{"description":"Currency created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrencyResponseDto"}}}}},"security":[{"bearer":[]}],"summary":"Create a new currency","tags":["currencies"]},"get":{"operationId":"CurrencyController_findAll","parameters":[],"responses":{"200":{"description":"List of currencies","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CurrencyResponseDto"}}}}}},"security":[{"bearer":[]}],"summary":"Get all currencies for current user","tags":["currencies"]}},"/currencies/{id}":{"get":{"operationId":"CurrencyController_findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Currency details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrencyResponseDto"}}}},"404":{"description":"Currency not found"}},"security":[{"bearer":[]}],"summary":"Get a specific currency","tags":["currencies"]},"patch":{"operationId":"CurrencyController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateCurrencyDto"}}}},"responses":{"200":{"description":"Currency updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrencyResponseDto"}}}},"404":{"description":"Currency not found"}},"security":[{"bearer":[]}],"summary":"Update a currency","tags":["currencies"]},"delete":{"operationId":"CurrencyController_remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Currency deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurrencyResponseDto"}}}},"404":{"description":"Currency not found"}},"security":[{"bearer":[]}],"summary":"Delete a currency","tags":["currencies"]}},"/contacts":{"post":{"operationId":"ContactsController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateContactDto"}}}},"responses":{"201":{"description":"Contact created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Contact"}}}}},"security":[{"bearer":[]}],"summary":"Create a new contact","tags":["contacts"]},"get":{"operationId":"ContactsController_findAll","parameters":[],"responses":{"200":{"description":"List of contacts with their balances","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ContactResponseDto"}}}}}},"security":[{"bearer":[]}],"summary":"Get all contacts for current user","tags":["contacts"]}},"/contacts/{id}":{"get":{"operationId":"ContactsController_findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Contact details with balances","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContactResponseDto"}}}},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Get a specific contact","tags":["contacts"]},"patch":{"operationId":"ContactsController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateContactDto"}}}},"responses":{"200":{"description":"Contact updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Contact"}}}},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Update a contact","tags":["contacts"]},"delete":{"operationId":"ContactsController_remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Contact deleted successfully"},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Delete a contact","tags":["contacts"]}},"/contacts/{id}/balance":{"get":{"operationId":"ContactsController_getBalance","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"currencyId","required":false,"in":"query","description":"Optional currency ID to filter balances","schema":{"type":"string"}}],"responses":{"200":{"description":"Contact balances per currency","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IntersectionBalancePickTypeClass"}}}}},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Get balances for a specific contact","tags":["contacts"]}},"/contacts/{id}/prepare-invite":{"get":{"operationId":"ContactsController_prepareInvite","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Invite message and inline keyboard prepared","content":{"application/json":{"schema":{"type":"string"}}}},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Prepare an invite message with inline button for Telegram","tags":["contacts"]}},"/contacts/{id}/transactions":{"get":{"operationId":"ContactsController_getTransactions","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"currencyId","required":false,"in":"query","description":"Optional currency ID to filter balances","schema":{"type":"string"}},{"name":"includeDeleted","required":false,"in":"query","description":"Set to true to include cancelled (soft-deleted) transactions","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IntersectionTransactionPickTypeClass"}}}}},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Get transactions for a specific contact","tags":["contacts"]}},"/contacts/{id}/recalculate-balance":{"post":{"operationId":"ContactsController_recalculateBalance","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Balances recalculated"},"201":{"description":""},"404":{"description":"Contact not found"}},"security":[{"bearer":[]}],"summary":"Recalculate balances for a contact","tags":["contacts"]}},"/transactions/topup":{"post":{"operationId":"TransactionsController_topup","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTransactionDto"}}}},"responses":{"201":{"description":"Balance topped up successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponseDto"}}}},"404":{"description":"Contact or currency not found"}},"security":[{"bearer":[]}],"summary":"Top up balance for a contact","tags":["transactions"]}},"/transactions/withdraw":{"post":{"operationId":"TransactionsController_withdraw","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTransactionDto"}}}},"responses":{"201":{"description":"Balance withdrawn successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponseDto"}}}},"404":{"description":"Contact or currency not found"}},"security":[{"bearer":[]}],"summary":"Withdraw balance from a contact","tags":["transactions"]}},"/transactions/{id}/cancel":{"post":{"operationId":"TransactionsController_cancel","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Transaction cancelled successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponseDto"}}}},"201":{"description":""},"404":{"description":"Transaction not found"}},"security":[{"bearer":[]}],"summary":"Cancel a transaction","tags":["transactions"]}},"/transactions/{id}":{"put":{"operationId":"TransactionsController_update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTransactionDto"}}}},"responses":{"200":{"description":"Transaction updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponseDto"}}}},"404":{"description":"Transaction not found"}},"security":[{"bearer":[]}],"summary":"Update a transaction (e.g., edit note)","tags":["transactions"]}},"/users/profile":{"get":{"operationId":"UsersController_getProfile","parameters":[],"responses":{"200":{"description":"Returns the current user profile","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"bearer":[]}],"summary":"Get current user profile","tags":["users"]},"put":{"operationId":"UsersController_updateProfile","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProfileDto"}}}},"responses":{"200":{"description":"Profile successfully updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"bearer":[]}],"summary":"Update current user profile","tags":["users"]}},"/users/password":{"put":{"operationId":"UsersController_updatePassword","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePasswordDto"}}}},"responses":{"200":{"description":"Password successfully updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"bearer":[]}],"summary":"Update current user password","tags":["users"]}}},"info":{"title":"Qarz.uz backend","description":"API for managing debts and loans","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"bearer":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"SignUpDto":{"type":"object","properties":{}},"AuthResponseDto":{"type":"object","properties":{"token":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"number"},"email":{"type":"string"},"telegram_id":{"type":"string"},"name":{"type":"string"}},"required":["id"]}},"required":["token","user"]},"SignInDto":{"type":"object","properties":{}},"TelegramAuthDto":{"type":"object","properties":{"initData":{"type":"string","description":"Telegram Web App init data string"}},"required":["initData"]},"CreateCurrencyDto":{"type":"object","properties":{"name":{"type":"string"},"symbol":{"type":"string"}},"required":["name","symbol"]},"CurrencyResponseDto":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"symbol":{"type":"string"},"createdAt":{"format":"date-time","type":"string"}},"required":["id","name","symbol","createdAt"]},"UpdateCurrencyDto":{"type":"object","properties":{"name":{"type":"string"},"symbol":{"type":"string"}}},"CreateContactDto":{"type":"object","properties":{"name":{"type":"string"},"ref_user_id":{"type":"number"}}},"Contact":{"type":"object","properties":{"id":{"type":"number"},"user_id":{"type":"number"},"name":{"type":"string"},"ref_user_id":{"type":"number"}},"required":["id","user_id"]},"Currency":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"symbol":{"type":"string"},"createdAt":{"format":"date-time","type":"string"}},"required":["id","name","symbol","createdAt"]},"IntersectionBalancePickTypeClass":{"type":"object","properties":{"currency_id":{"type":"number"},"amount":{"type":"number"},"contact_id":{"type":"number"},"updatedAt":{"format":"date-time","type":"string"},"currency":{"$ref":"#/components/schemas/Currency"}},"required":["currency_id","amount","contact_id","updatedAt","currency"]},"ContactResponseDto":{"type":"object","properties":{"id":{"type":"number"},"user_id":{"type":"number"},"name":{"type":"string"},"ref_user_id":{"type":"number"},"Balance":{"type":"array","items":{"$ref":"#/components/schemas/IntersectionBalancePickTypeClass"}}},"required":["id","user_id","Balance"]},"UpdateContactDto":{"type":"object","properties":{"name":{"type":"string"},"ref_user_id":{"type":"number"}}},"IntersectionTransactionPickTypeClass":{"type":"object","properties":{"id":{"type":"number"},"contact_id":{"type":"number"},"currency_id":{"type":"number"},"user_id":{"type":"number"},"amount":{"type":"number"},"note":{"type":"string"},"draftId":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"deletedAt":{"format":"date-time","type":"string"},"currency":{"$ref":"#/components/schemas/Currency"}},"required":["id","currency_id","user_id","amount","createdAt","updatedAt","currency"]},"CreateTransactionDto":{"type":"object","properties":{"contact_id":{"type":"number"},"currency_id":{"type":"number"},"amount":{"type":"number"},"note":{"type":"string"}},"required":["currency_id","amount"]},"TransactionResponseDto":{"type":"object","properties":{"id":{"type":"number"},"contact_id":{"type":"number"},"currency_id":{"type":"number"},"user_id":{"type":"number"},"amount":{"type":"number"},"note":{"type":"string"},"draftId":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"deletedAt":{"format":"date-time","type":"string"}},"required":["id","currency_id","user_id","amount","createdAt","updatedAt"]},"UpdateTransactionDto":{"type":"object","properties":{"note":{"type":"string"}}},"ProfileDto":{"type":"object","properties":{"id":{"type":"number","description":"User ID"},"name":{"type":"string","nullable":true,"description":"User display name","example":"John Doe"},"email":{"type":"string","nullable":true,"description":"User email address","example":"john@example.com"},"telegram_id":{"type":"string","nullable":true,"description":"Telegram ID","example":"123456789"},"is_verified":{"type":"boolean","description":"Account verification status"},"createdAt":{"format":"date-time","type":"string","description":"Account creation date"}},"required":["id","name","email","telegram_id","is_verified","createdAt"]},"UpdateProfileDto":{"type":"object","properties":{"name":{"type":"string","description":"User display name"},"email":{"type":"string","format":"email","description":"User email address","example":"user@example.com"}}},"UpdatePasswordDto":{"type":"object","properties":{"currentPassword":{"type":"string","description":"Current password"},"newPassword":{"type":"string","minLength":6,"description":"New password","example":"newpassword123"}},"required":["currentPassword","newPassword"]},"Transaction":{"type":"object","properties":{"id":{"type":"number"},"contact_id":{"type":"number"},"currency_id":{"type":"number"},"user_id":{"type":"number"},"amount":{"type":"number"},"note":{"type":"string"},"draftId":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"deletedAt":{"format":"date-time","type":"string"}},"required":["id","currency_id","user_id","amount","createdAt","updatedAt"]},"UserRelations":{"type":"object","properties":{"contacts":{"type":"array","items":{"$ref":"#/components/schemas/Contact"}},"transactions":{"type":"array","items":{"$ref":"#/components/schemas/Transaction"}},"isContactFor":{"type":"array","items":{"$ref":"#/components/schemas/Contact"}}},"required":["contacts","transactions","isContactFor"]},"Balance":{"type":"object","properties":{"currency_id":{"type":"number"},"amount":{"type":"number"},"contact_id":{"type":"number"},"updatedAt":{"format":"date-time","type":"string"}},"required":["currency_id","amount","contact_id","updatedAt"]},"CurrencyRelations":{"type":"object","properties":{"balances":{"type":"array","items":{"$ref":"#/components/schemas/Balance"}},"transactions":{"type":"array","items":{"$ref":"#/components/schemas/Transaction"}}},"required":["balances","transactions"]},"BalanceRelations":{"type":"object","properties":{"currency":{"$ref":"#/components/schemas/Currency"},"contact":{"$ref":"#/components/schemas/Contact"}},"required":["currency","contact"]},"User":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"telegram_id":{"type":"string"},"verification_code":{"type":"string"},"is_verified":{"type":"boolean"}},"required":["id","createdAt","updatedAt","is_verified"]},"TransactionRelations":{"type":"object","properties":{"contact":{"$ref":"#/components/schemas/Contact"},"currency":{"$ref":"#/components/schemas/Currency"},"user":{"$ref":"#/components/schemas/User"}},"required":["currency","user"]},"ContactRelations":{"type":"object","properties":{"user":{"$ref":"#/components/schemas/User"},"ref_user":{"$ref":"#/components/schemas/User"},"Transaction":{"type":"array","items":{"$ref":"#/components/schemas/Transaction"}},"Balance":{"type":"array","items":{"$ref":"#/components/schemas/Balance"}}},"required":["user","Transaction","Balance"]}}}}